<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<title>æ—¶ä»£æ®‹å…š</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="icon" href="/favicon.png">
<meta property="og:type" content="website">
<meta property="og:title" content="æ—¶ä»£æ®‹å…š">
<meta property="og:url" content="https://zxs66.github.io/">
<meta property="og:site_name" content="æ—¶ä»£æ®‹å…š">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="æ—¶ä»£æ®‹å…š">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="Angular">
<meta property="article:tag" content="NodeJS">
<meta property="article:tag" content="SQL">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="ASP.NET">
<meta property="article:tag" content="Full Stack">
<meta name="twitter:card" content="summary">
<link rel="dns-prefetch" href="https://cdn.bootcdn.net/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://fonts.gstatic.com/">
<meta name="baidu-site-verification" content="1W34rVIdAO" />

<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous" integrity="sha256-eZrrJcwDc&#x2F;3uDhsdt61sL2oOBY362qM3lon1gyExkL0&#x3D; sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN sha512-SfTiTlX6kk+qitfevl&#x2F;7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+&#x2F;Sw&#x3D;&#x3D;">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro" />


<link rel="stylesheet" href="/css/style.css">

<link rel="manifest" href="/manifest.json">
<script type="module" src="/pwabuilder-sw-register.js"></script>
<!-- ç™¾åº¦ç»Ÿè®¡ -->
<script>
var _hmt = _hmt || [];
(function () {
var hm = document.createElement("script");
hm.src = "https://hm.baidu.com/hm.js?de1c4b02a9f8a51a6001797e045d3af9";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();
</script>
</head><body>
<div id="container">
<div id="wrap">
<header id="header">
<div id="banner"></div>
<div id="header-outer" class="outer">
<div id="header-title" class="inner">
<h1 id="logo-wrap">
<a href="/" id="logo">æ—¶ä»£æ®‹å…š</a>
</h1>

<h2 id="subtitle-wrap">
<a href="/" id="subtitle">éšæ‰‹ç¬”è®°</a>
</h2>

</div>
<div id="header-inner" class="inner">
<nav id="main-nav">
<a id="main-nav-toggle" class="nav-icon"></a>

<a class="main-nav-link" href="/">é¦–é¡µ</a>

<a class="main-nav-link" href="/archives">å½’æ¡£</a>

<a class="main-nav-link" href="/app">è”ç³»æˆ‘</a>

</nav>
<div id="search-form-wrap">
<div class="search-form"><input type="search" name="wd" class="search-form-input" placeholder="Search" list="search-datalist" autocomplete="false"/></div>

<input type="hidden" id="search-index-file" value="/search.json" />
<div id="search-form-datalist"></div>

</div>
<nav id="sub-nav">

<a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
</nav>
</div>
</div>
</header>
<div class="outer">
<section id="main">


<article id="post-setup-wsl-development-environment" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/11/10/setup-wsl-development-environment/" class="article-date">
  <time datetime="2022-11-10T13:50:30.000Z" itemprop="datePublished">2022-11-10</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/11/10/setup-wsl-development-environment/">é…ç½® WSL å¼€å‘ç¯å¢ƒ</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><h3 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h3><h5 id="å¯ç”¨è™šæ‹ŸåŒ–å’ŒWSL"><a href="#å¯ç”¨è™šæ‹ŸåŒ–å’ŒWSL" class="headerlink" title="å¯ç”¨è™šæ‹ŸåŒ–å’ŒWSL"></a>å¯ç”¨è™šæ‹ŸåŒ–å’ŒWSL</h5><p><img src="/images/setup-wsl-development-environment/turn-on-or-off-windows-features.jpg" alt="å¯ç”¨æˆ–å…³é—­WindowsåŠŸèƒ½"></p>
<p>å®Œæˆä¹‹åéœ€è¦é‡å¯ã€‚</p>
<h5 id="å¯ç”¨WSL"><a href="#å¯ç”¨WSL" class="headerlink" title="å¯ç”¨WSL"></a>å¯ç”¨WSL</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --install</span><br></pre></td></tr></table></figure>
<p>å®Œæˆä¹‹å<em>å¯èƒ½</em>éœ€è¦é‡å¯ã€‚</p>
<h5 id="å®‰è£…Windows-Terminal"><a href="#å®‰è£…Windows-Terminal" class="headerlink" title="å®‰è£…Windows Terminal"></a>å®‰è£…Windows Terminal</h5><p>åœ¨ Microsoft Store ï¼ˆåº”ç”¨å•†åŸï¼‰ä¸­æœç´¢ Windows Terminal å³å¯ä¸€é”®å®‰è£…ï¼Œæ­¤å¤„çœã€‚</p>
<h5 id="å®‰è£…Ubuntu"><a href="#å®‰è£…Ubuntu" class="headerlink" title="å®‰è£…Ubuntu"></a>å®‰è£…Ubuntu</h5><p>æœ‰å¤šç§æ–¹å¼å¯ä»¥å®‰è£… Ubuntuã€‚æœ€ç®€å•çš„æ–¹å¼ï¼Œå°±æ˜¯å’Œä¸Šä¸€æ­¥ä¸€æ ·ï¼Œåœ¨ Microsoft Store ï¼ˆåº”ç”¨å•†åŸï¼‰ä¸­æœç´¢ Ubuntu å³å¯ä¸€é”®å®‰è£…ï¼Œæ­¤å¤„çœã€‚</p>
<h5 id="é…ç½®-apt-å›½å†…è½¯ä»¶æºé•œåƒ"><a href="#é…ç½®-apt-å›½å†…è½¯ä»¶æºé•œåƒ" class="headerlink" title="é…ç½® apt å›½å†…è½¯ä»¶æºé•œåƒ"></a>é…ç½® apt å›½å†…è½¯ä»¶æºé•œåƒ</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.20221110.bak <span class="comment"># å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</span></span><br><span class="line">sudo vim /etc/apt/sources.list <span class="comment"># æ›¿æ¢å›½å†…é•œåƒæºä»¥åŠ é€Ÿï¼Œæ ¹æ® Ubuntu ä¸åŒç‰ˆæœ¬å·ï¼Œé€‰æ‹©ä¸åŒçš„è·¯å¾„</span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæˆ‘åœ¨ä¸Šæµ·ï¼Œä½¿ç”¨çš„åˆæ˜¯ Ubuntu 22.04ï¼Œæ‰€ä»¥æˆ‘çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-updates main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-updates main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-backports main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-backports main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-security main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-proposed main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-proposed main restricted universe multiverse</span><br></pre></td></tr></table></figure>

<h5 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h5><p>å®‰è£…å®Œæˆä¹‹åï¼Œæ‰“å¼€ Windows Terminalï¼Œé€‰æ‹© Ubuntuï¼š</p>
<p><img src="/images/setup-wsl-development-environment/windows-terminal.jpg" alt="Windows Terminal"></p>
<p>ç¬¬ä¸€æ¬¡æ‰“å¼€ä¼šæç¤ºè®¾ç½®ç”¨æˆ·åå¯†ç ï¼ˆè¶…çº§ç”¨æˆ·æƒé™ï¼‰ã€‚</p>
<h5 id="Windows-ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…"><a href="#Windows-ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…" class="headerlink" title="Windows ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…"></a>Windows ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…</h5><p>æ ¹æ®å„å¼€å‘è€…æŠ€æœ¯æ ˆä¸åŒï¼Œéœ€è¦å®‰è£…çš„è½¯ä»¶ä¼šæœ‰æ‰€ä¸åŒã€‚åŒ…æ‹¬ä½†ä¸é™äºï¼š<a href="https://www.docker.com/products/docker-desktop/" target="_blank" rel="noopener">Docker Desktop</a>ã€<a href="https://code.visualstudio.com" target="_blank" rel="noopener">Visual Studio Code</a>ã€<a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack" target="_blank" rel="noopener">Remote Development Extension Pack</a></p>
<h5 id="WSL-ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…"><a href="#WSL-ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…" class="headerlink" title="WSL ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…"></a>WSL ç¯å¢ƒå¿…è¦è½¯ä»¶å®‰è£…</h5><p>æ ¹æ®å„å¼€å‘è€…æŠ€æœ¯æ ˆä¸åŒï¼Œéœ€è¦å®‰è£…çš„è½¯ä»¶ä¼šæœ‰æ‰€ä¸åŒã€‚åŒ…æ‹¬ä½†ä¸é™äºï¼š<a href="https://git-scm.com/download/linux" target="_blank" rel="noopener">git</a>ã€<a href="https://nodejs.org" target="_blank" rel="noopener">node.js</a>ã€<a href="https://www.python.org/downloads/" target="_blank" rel="noopener">python</a></p>
<h5 id="GitHub-åŠ é€Ÿ"><a href="#GitHub-åŠ é€Ÿ" class="headerlink" title="GitHub åŠ é€Ÿ"></a>GitHub åŠ é€Ÿ</h5><p>å…¶å®ï¼Œç°åœ¨å¥½å¤šåŠæ³•éƒ½å¯ä»¥åŠ é€Ÿè®¿é—® <a href="https://github.com" target="_blank" rel="noopener">GitHub</a>ï¼Œæˆ‘è¿™é‡Œä»‹ç»ä¸€ç§ç‰¹åˆ«åŸå§‹çš„åŠæ³•ï¼Œå°±æ˜¯ä¿®æ”¹ hosts æ–‡ä»¶ã€‚</p>
<ol>
<li>ä»¥ç®¡ç†å‘˜æƒé™ï¼Œæ‰“å¼€è®°äº‹æœ¬</li>
<li>è®°äº‹æœ¬ä¸­æ‰“å¼€ <code>C:\Windows\System32\drivers\etc\hosts</code> æ–‡ä»¶</li>
<li>æ·»åŠ ä»¥ä¸‹ IP æ˜ å°„ï¼š<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éœ€è¦å®šæœŸæ›´æ–°å¦‚ä¸‹ä»£ç </span></span><br><span class="line"><span class="comment"># Newï¼æ¬¢è¿ä½¿ç”¨åŸºäºDNSçš„æ–°æ–¹æ¡ˆ</span></span><br><span class="line"><span class="comment"># https://gitlab.com/ineo6/hosts/-/raw/master/next-hosts</span></span><br><span class="line"><span class="comment"># åœ°å€å¯èƒ½ä¼šå˜åŠ¨ï¼Œè¯·åŠ¡å¿…å…³æ³¨GitHubã€Gitlabè·å–æœ€æ–°æ¶ˆæ¯</span></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥å…³æ³¨å…¬ä¼—å·ï¼šæ¹–ä¸­å‰‘ï¼Œä¿è¯ä¸è¿·è·¯</span></span><br><span class="line"><span class="comment"># GitHub Host Start</span></span><br><span class="line"></span><br><span class="line">140.82.114.3                 central.github.com</span><br><span class="line">140.82.114.3                 assets-cdn.github.com</span><br><span class="line">151.101.1.6                  github.map.fastly.net</span><br><span class="line">151.101.1.6                  github.global.ssl.fastly.net</span><br><span class="line">140.82.114.3                 gist.github.com</span><br><span class="line">185.199.108.153              github.io</span><br><span class="line">140.82.114.3                 github.com</span><br><span class="line">140.82.114.3                 api.github.com</span><br><span class="line">140.82.114.3                 codeload.github.com</span><br><span class="line">72.21.206.80                 github-cloud.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-com.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-production-release-asset-2e65be.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-production-user-asset-6210df.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-production-repository-file-5c1aeb.s3.amazonaws.com</span><br><span class="line">185.199.108.153              githubstatus.com</span><br><span class="line">140.82.113.18                github.community</span><br><span class="line">140.82.114.3                 raw.github.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># Please Star : https://github.com/ineo6/hosts</span></span><br><span class="line"><span class="comment"># Mirror Repo : https://gitlab.com/ineo6/hosts</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Update at: 2022-11-10 16:20:33</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GitHub Host End</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>å½“ç„¶ï¼Œä¹Ÿæœ‰å…¶ä»–çš„æä¾›æœ€æ–° hostsï¼ˆæ¯”å¦‚ <a href="https://raw.hellogithub.com/hosts" target="_blank" rel="noopener">https://raw.hellogithub.com/hosts</a> ) æˆ–è€…è‡ªåŠ¨ switchhostsï¼ˆæ¯”å¦‚ <a href="https://github.com/oldj/SwitchHosts" target="_blank" rel="noopener">https://github.com/oldj/SwitchHosts</a> ï¼‰ï¼Œæˆ–è€…å…¶ä»–ç§‘å­¦ä¸Šç½‘æ–¹å¼ï¼Œæ„Ÿå…´è¶£çš„è¯·è‡ªè¡Œæœç´¢ã€‚</p>
<h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><ul>
<li><a href="https://learn.microsoft.com/en-us/windows/wsl/install" target="_blank" rel="noopener"><i class="fa fa-windows" aria-hidden="true"></i>Install Linux on Windows with WSL</a></li>
<li><a href="https://mirrors.sjtug.sjtu.edu.cn/docs/ubuntu" target="_blank" rel="noopener">ä¸Šæµ·äº¤é€šå¤§å­¦ Linux ç”¨æˆ·ç»„ è½¯ä»¶æºé•œåƒæœåŠ¡</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/wsl/setup/environment" target="_blank" rel="noopener"><i class="fa fa-windows" aria-hidden="true"></i>Set up a WSL development environment</a></li>
<li><a href="https://ineo6.github.io/hosts/" target="_blank" rel="noopener"><i class="fa fa-github" aria-hidden="true"></i>GitHub Hosts | hosts</a></li>
</ul>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/11/10/setup-wsl-development-environment/" data-id="clbrr63ho00c7m08cdh1326cc" data-title="é…ç½® WSL å¼€å‘ç¯å¢ƒ" class="article-share-link">åˆ†äº«</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wsl/" rel="tag">wsl</a></li></ul>

</footer>
</div>

</article>



<article id="post-csv-to-excel-file" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/07/14/csv-to-excel-file/" class="article-date">
  <time datetime="2022-07-14T05:15:25.000Z" itemprop="datePublished">2022-07-14</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/07/14/csv-to-excel-file/">CSVè½¬Excel</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<p>æœ¬ç¯‡æ˜¯æ¥ <a href="/2022/05/13/dotnet-core-build-standalone-executable-program/">ä¸Šä¸€ç¯‡æ–‡ç« </a>ï¼Œå…·ä½“åˆ° CSV è½¬ Excel è¿™ä¸€ä¸ªåœºæ™¯ä¸‹çš„å®é™…åº”ç”¨ã€‚</p>
<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>ä¸€èˆ¬ä»æ•°æ®åº“(æ¯”å¦‚ MySQL æˆ–è€… SQL Server)æˆ–è€…ä¸€äº›æ•°æ®å¹³å°ï¼ˆæ¯”å¦‚ Symantec æ—¥å¿—ï¼‰å¯¼å‡ºçš„ CSV æ–‡ä»¶ï¼ŒåŸºæœ¬éƒ½æ˜¯é‡‡ç”¨ <code>UTF-8</code> ç¼–ç ä¿å­˜çš„æ–‡ä»¶ã€‚ä½¿ç”¨ <code>UTF-8</code> ä¿å­˜çš„ CSV æ–‡ä»¶ä½œä¸ºé€šç”¨çš„ä¼ è¾“æ•°æ®åª’ä»‹ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ç„¶è€Œï¼Œæœ‰ä¸€äº›æœ‹å‹ï¼Œä½¿ç”¨ CSV æ–‡ä»¶å¹¶ä¸ä¸€å®šæ˜¯ç”¨æ¥ä¼ è¾“æ•°æ®çš„ï¼Œè€Œæ˜¯ç”¨æ¥æŸ¥çœ‹çš„ã€‚è¿™äº›æƒ…å†µä¸‹ï¼Œä»–ä»¬ä¼šå°è¯•ä½¿ç”¨ Microsoft Excel æ‰“å¼€ã€‚å“¦é¢ï¼Œé—®é¢˜æ¥äº†ï¼ŒExcel ä¸€èˆ¬ä¸ä¼šä¼˜å…ˆä½¿ç”¨ <code>UTF-8</code> ç¼–ç æ‰“å¼€ CSV æ–‡ä»¶ï¼Œç»“æœå°±æ˜¯ä¹±ç ã€‚</p>
<p>ä¸€èˆ¬çš„é€šç”¨è§£å†³åŠæ³•æ˜¯ï¼š</p>
<p><strong>ä½¿ç”¨ Excel çš„â€œæ•°æ®â€èœå•ï¼Œé€‰æ‹©â€œè‡ªæ–‡æœ¬â€ï¼Œç„¶åé€šè¿‡ä¸€äº›åˆ—çš„é¼ æ ‡ç‚¹ç‚¹ç‚¹æ“ä½œï¼ŒæŠŠ CSV æ–‡ä»¶åŠ è½½åˆ° Excel ä¸­ï¼ˆå…·ä½“ç»†èŠ‚è¯·å‚è€ƒå„å¤§æœç´¢å¼•æ“æˆ–åšå®¢ï¼‰ã€‚</strong></p>
<p><del>æœ¬ç¯‡å®Œï¼</del>ğŸ˜„</p>
<p>æ—¢ç„¶èº«ä¸ºç¨‹åºå‘˜ï¼Œæœ€ä¸èƒ½å®¹å¿çš„äº‹æƒ…å°±æ˜¯é‡å¤è‡ªå·±ï¼æœ€å–œæ¬¢åšçš„äº‹æƒ…å°±æ˜¯é‡å¤é€ è½®å­ã€‚ğŸ˜</p>
<h1 id="æŠ€æœ¯ç®€ä»‹"><a href="#æŠ€æœ¯ç®€ä»‹" class="headerlink" title="æŠ€æœ¯ç®€ä»‹"></a>æŠ€æœ¯ç®€ä»‹</h1><p>ç›´å…¥ä¸»é¢˜ï¼Œå¦‚ä½•ä½¿ç”¨ä»£ç ï¼Œæ‰èƒ½æŠŠ CSV è½¬æ¢æˆ Excel æ ¼å¼ï¼Ÿ</p>
<ol>
<li>é€‰æ‹©ç¼–ç¨‹è¯­è¨€</li>
<li>è¯»å– CSV æ–‡ä»¶æ–‡æœ¬å†…å®¹</li>
<li>æŒ‰ CSVï¼ˆComma Separated Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®</li>
<li>æŒ‰ Excel æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ Excel æ–‡ä»¶</li>
<li>ä¿å­˜ Excel æ–‡ä»¶</li>
</ol>
<h3 id="é€‰æ‹©ç¼–ç¨‹è¯­è¨€"><a href="#é€‰æ‹©ç¼–ç¨‹è¯­è¨€" class="headerlink" title="é€‰æ‹©ç¼–ç¨‹è¯­è¨€"></a>é€‰æ‹©ç¼–ç¨‹è¯­è¨€</h3><p>è¿™ä¸ªå°±æ— æ‰€è°“äº†ï¼Œæ—¢ç„¶æ˜¯é€ è½®å­ï¼Œå“ªä¸ªè¯­è¨€é¡ºæ‰‹å°±ç”¨å“ªä¸ªã€‚</p>
<h3 id="è¯»å–-CSV-æ–‡ä»¶å†…å®¹"><a href="#è¯»å–-CSV-æ–‡ä»¶å†…å®¹" class="headerlink" title="è¯»å– CSV æ–‡ä»¶å†…å®¹"></a>è¯»å– CSV æ–‡ä»¶å†…å®¹</h3><h3 id="æŒ‰-CSVï¼ˆComma-Separated-Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®"><a href="#æŒ‰-CSVï¼ˆComma-Separated-Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®" class="headerlink" title="æŒ‰ CSVï¼ˆComma Separated Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®"></a>æŒ‰ CSVï¼ˆComma Separated Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®</h3><p>ä¸Šé¢ä¸¤ä¸ªå†…å®¹æˆ‘æ”¾ä¸€èµ·ï¼Œä¸»è¦æ˜¯<del>æˆ‘æ‡’</del>è€ƒè™‘åˆ°è¯»å– CSV æ–‡ä»¶å®åœ¨æ˜¯å¤ªå¸¸è§äº†ï¼Œç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘è¿™é‡Œå¼•ç”¨çš„æ˜¯ <a href="">ClosedXML</a>ã€‚</p>
<h3 id="æŒ‰-Excel-æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ-Excel-æ–‡ä»¶"><a href="#æŒ‰-Excel-æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ-Excel-æ–‡ä»¶" class="headerlink" title="æŒ‰ Excel æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ Excel æ–‡ä»¶"></a>æŒ‰ Excel æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ Excel æ–‡ä»¶</h3><h3 id="ä¿å­˜-Excel-æ–‡ä»¶"><a href="#ä¿å­˜-Excel-æ–‡ä»¶" class="headerlink" title="ä¿å­˜ Excel æ–‡ä»¶"></a>ä¿å­˜ Excel æ–‡ä»¶</h3><p>åŒä¸Šï¼Œä¿å­˜æ•°æ®åˆ° Excel ä¹Ÿå¤ªç¨€ç–å¹³å¸¸äº†ã€‚æˆ‘è¿™é‡Œå¼•ç”¨çš„æ˜¯ <a href="">ClosedXML</a>ã€‚</p>
<p>ç»¼ä¸Šï¼Œæˆ‘ä»¬éœ€è¦åšçš„ï¼Œå°±éå¸¸å°‘äº†ï¼Œä»…å‰©ä¸€äº›ä¸šåŠ¡ä»£ç ã€‚</p>
<p><a href="https://github.com/ZXS66/csv2excel" target="_blank" rel="noopener">ç‚¹å‡»æ­¤å¤„</a> æŸ¥çœ‹æºä»£ç ã€‚</p>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/07/14/csv-to-excel-file/" data-id="clbrr63g0002bm08c3l7056xe" data-title="CSVè½¬Excel" class="article-share-link">åˆ†äº«</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csv/" rel="tag">csv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/encoding/" rel="tag">encoding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/excel/" rel="tag">excel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gb2312/" rel="tag">gb2312</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unicode/" rel="tag">unicode</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/utf-8/" rel="tag">utf-8</a></li></ul>

</footer>
</div>

</article>



<article id="post-MySQL-regex-for-multi-bytes-character" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/06/25/MySQL-regex-for-multi-bytes-character/" class="article-date">
  <time datetime="2022-06-25T09:30:04.000Z" itemprop="datePublished">2022-06-25</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/06/25/MySQL-regex-for-multi-bytes-character/">MySQL æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒå¤šå­—èŠ‚å­—ç¬¦</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘åœ¨å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯éœ€è¦ä¸€äº›ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…ï¼Œè‡ªç„¶è€Œç„¶æƒ³åˆ°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼äº†ã€‚ç®€å•æœç´¢äº†ä¸€ä¸‹ï¼Œ<code>MySQL</code> ä¸­å¦‚ä½•ä½¿ç”¨æ­£åˆ™ï¼ŒåŸºæœ¬ä¸Šéƒ½ä»‹ç»ç”¨ <a href="https://dev.mysql.com/doc/refman/8.0/en/regexp.html" target="_blank" rel="noopener">REGEXP</a> å‡½æ•°ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸ªé™åˆ¶ï¼Œåœ¨ MySQL 8.0.4 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå®ƒæ˜¯æŒ‰å­—èŠ‚åŒ¹é…çš„ï¼Œè€Œä¸æ˜¯å­—ç¬¦ï¼æ¢å¥è¯è¯´ï¼Œå¯¹äºæ±‰å­—æˆ–è€… Emoji è¿™æ ·å¤šå­—èŠ‚çš„å­—ç¬¦ï¼Œå®ƒä¸æ”¯æŒï¼</p>
<blockquote>
<p>The REGEXP and RLIKE operators work in byte-wise fashion, so they are not multibyte safe and may produce unexpected results with multibyte character sets. In addition, these operators compare characters by their byte values and accented characters may not compare as equal even if a given collation treats them as equal. <a href="https://dev.mysql.com/doc/refman/5.6/en/regexp.html" target="_blank" rel="noopener"><a href="https://your-link.here" target="_blank" rel="noopener"><fa-link/></a></a></p>
</blockquote>
<p>æ‰€ä»¥ï¼Œåœ¨ MySQL 8.0.4 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•é’ˆå¯¹å¤šå­—èŠ‚çš„å­—ç¬¦ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å‘¢ï¼Ÿ</p>
<p>å‡çº§ MySQLï¼Ÿå¥½å§ï¼Œå½“æˆ‘æ²¡é—®ã€‚ğŸ™Š</p>
<p>é’ˆå¯¹ä¸€ä¸ªçº¿ä¸Šçš„ MySQLï¼Œå¦‚æœè¦å¿…é¡»è¦å®ç°ä¸šåŠ¡é€»è¾‘ï¼Œåˆä¸èƒ½å˜æ›´ MySQLï¼Œæœ‰ä»€ä¹ˆå¥½çš„åŠæ³•ï¼Ÿ</p>
<p>ä¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œé‡‡ç”¨ IF ELSE è¯­å¥æ›¿ä»£ï¼Ÿä¹Ÿä¸æ˜¯ä¸å¯ä»¥ï¼Œä½†æ˜¯é€»è¾‘ç¨è´Ÿè´£ä¸€ç‚¹ï¼ŒSQL è„šæœ¬å°±å¼€å§‹å˜å¾—å†—é•¿ã€æ€§èƒ½ä½ä¸‹ä¸”éš¾ä»¥ç»´æŠ¤äº†ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±çš„ç»éªŒæ€»ç»“ï¼Œä»…ä¾›å‚è€ƒã€‚</p>
<h1 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h1><p>æ—¢ç„¶ MySQL 8.0.4 ä¹‹å‰çš„ REGEXP åªèƒ½æ”¯æŒå•å­—èŠ‚ï¼Œé‚£æˆ‘æŠŠå¤šå­—èŠ‚å­—ç¬¦éƒ½æ›¿æ¢æˆå•å­—èŠ‚å­—ç¬¦å†æ­£åˆ™åŒ¹é…ä¸å°±è¡Œäº†ï¼Ÿ<a href="https://dev.mysql.com/doc/refman/8.0/en/replace.html" target="_blank" rel="noopener">REPLACE</a> å‡½æ•°æ˜¯æ”¯æŒå¤šå­—èŠ‚çš„ã€‚</p>
<h1 id="æ”¾ç "><a href="#æ”¾ç " class="headerlink" title="æ”¾ç "></a>æ”¾ç </h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">USE</span> <span class="string">`project_otis2019`</span>$$</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`fx_regexp_over_multi_characters_sample`</span>$$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DEFINER=<span class="string">`zxs66`</span>@<span class="string">`%`</span> <span class="keyword">FUNCTION</span> <span class="string">`fx_regexp_over_multi_characters_sample`</span>(<span class="keyword">content</span> <span class="built_in">TEXT</span>) <span class="keyword">RETURNS</span> <span class="built_in">TINYINT</span>(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">COMMENT</span> <span class="string">'check if given content match specific regular expression'</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">DECLARE</span> normalized_content <span class="built_in">TEXT</span>;</span><br><span class="line">	<span class="keyword">SET</span> normalized_content=<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(</span><br><span class="line">					<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(</span><br><span class="line">						<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">content</span>,<span class="string">'æ°´æœ'</span>,<span class="string">'`'</span>),<span class="string">'è”¬èœ'</span>,<span class="string">'`'</span>),<span class="string">'ç‰›å¥¶'</span>,<span class="string">'`'</span>),<span class="string">'ç‰›ç¾Šè‚‰'</span>,<span class="string">'`'</span>),<span class="string">'æ‚ç²®'</span>,<span class="string">'`'</span>),</span><br><span class="line">						<span class="string">'ï¼Œ'</span>,<span class="string">','</span>),<span class="string">'ï¼›'</span>,<span class="string">','</span>),<span class="string">'ã€‚'</span>,<span class="string">','</span>),</span><br><span class="line">						<span class="string">'ç§æ¤'</span>,<span class="string">'@'</span>),<span class="string">'è¿è¾“'</span>,<span class="string">'@'</span>),<span class="string">'å‚¨è—'</span>,<span class="string">'@'</span>),<span class="string">'é”€å”®'</span>,<span class="string">'@'</span>),<span class="string">'æ£€éªŒ'</span>,<span class="string">'@'</span>),<span class="string">'ä¿ä¾›'</span>,<span class="string">'@'</span>),<span class="string">'æ‰¹å‘'</span>,<span class="string">'@'</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">-- the regular expression below can be revised based on your actual bussiness requirements.</span></span><br><span class="line">	RETURN normalized_content REGEXP '`[^,;\.]*@' OR normalized_content REGEXP '@[^,;\.]*`'; </span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h1 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h1><p>ä¸Šè¿°è„šæœ¬ä»…æä¾›ä¸€ç§æ€è·¯ï¼Œè‚¯å®šä¸æ˜¯æœ€ä¼˜è§£ï¼Œè¿˜å­˜åœ¨è¯¸å¤šå¼Šç«¯ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é—®é¢˜å°±æ˜¯ï¼Œæ›¿æ¢æ‰çš„å•å­—èŠ‚å­—ç¬¦ä¸èƒ½ä¸åŸæ¥çš„æ–‡ä»¶å†…å®¹æœ‰å†²çªã€‚å¦‚æœæœ‰ä¸åŒæ„è§ï¼Œè¿˜è¯·ä¸åèµæ•™ã€‚</p>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/06/25/MySQL-regex-for-multi-bytes-character/" data-id="clbrr63fm000ym08c6qqda64d" data-title="MySQL æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒå¤šå­—èŠ‚å­—ç¬¦" class="article-share-link">åˆ†äº«</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multi-bytes/" rel="tag">multi-bytes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/regex/" rel="tag">regex</a></li></ul>

</footer>
</div>

</article>




<nav id="page-nav">

<span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/2/">ä¸‹ä¸€é¡µ &gt;</a>
</nav>

<style>
.article {max-height: 123vh;overflow: hidden;position: relative;}
.article.unfold {max-height: initial;}
.article .more {position: absolute;bottom: 0;padding: 3em;cursor: pointer;text-align: center;width: 100%;background: linear-gradient(rgba(0, 0, 0, 0), silver);color: white;box-sizing: border-box;}
.article.unfold .more {display: none;}
</style>
<script>
(function () {
// show more
const moreText = '<i class="fa fa-arrow-circle-down" aria-hidden="true"></i> ' + "æ›´å¤š";
const articles = document.getElementsByClassName('article');
for (let i = 0; i < articles.length; i++) {
const $more = document.createElement('div');
$more.classList.add('more');$more.innerHTML = moreText;
$more.onclick = function (evt) {
const $src = evt.target || evt.srcElement;$src.parentElement.classList.add('unfold');
};
articles[i].appendChild($more);
}})();
</script>
</section>

</div>
<footer id="footer">

<div class="outer"><div id="footer-info" class="inner">&copy; 2022 æ—¶ä»£æ®‹å…š<br>
Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></div>
</div></footer>
</div>
<nav id="mobile-nav">

<a href="/" class="mobile-nav-link">home</a>

<a href="/archives" class="mobile-nav-link">archives</a>

<a href="/app" class="mobile-nav-link">contact</a>

</nav>
<!--

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/2.0.3/jquery.min.js" crossorigin="anonymous" integrity="sha256-pXtSQrmprcTB74RsNlFHuJxHK5zXcPrOMx78uWU0ayU&#x3D; sha384-ECTndYny330R2jlSXBiZkdXzAVi0Z&#x2F;iDXJTwV6cp39HECmalqg6+b2sFZFf&#x2F;Y2m6 sha512-epzJ9ms+0Pq+zFMrG1lXVNvjEXgtfKx9iuEWqz3hmbaU2m&#x2F;Dp1pcmpYzuSdDLqX6PMIjzMOyGFwMc+SkgFhMFg&#x3D;&#x3D;"></script>

-->

<script src="/js/script.js" async></script>

</div>
<script>
(function () {
// append image-caption
const images = document.querySelectorAll('article img');
for (let j = 0; j < images.length; j++) {
const $img = images[j];
const altText = $img.getAttribute('alt');
if (altText && altText.length && !$img.classList.contains('inline')) {
const $imgCaption = document.createElement('div');
$imgCaption.classList.add('img-caption');
$imgCaption.innerText = $img.getAttribute('alt');
$img.parentNode.insertBefore($imgCaption, $img.nextSibling);
}}})();
</script>
</body></html>