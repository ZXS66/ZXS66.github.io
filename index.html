<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<title>æ—¶ä»£æ®‹å…š</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="icon" href="/favicon.png">
<meta property="og:type" content="website">
<meta property="og:title" content="æ—¶ä»£æ®‹å…š">
<meta property="og:url" content="https://zxs66.github.io/">
<meta property="og:site_name" content="æ—¶ä»£æ®‹å…š">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="æ—¶ä»£æ®‹å…š">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="Angular">
<meta property="article:tag" content="NodeJS">
<meta property="article:tag" content="SQL">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="ASP.NET">
<meta property="article:tag" content="Full Stack">
<meta name="twitter:card" content="summary">
<link rel="dns-prefetch" href="https://cdn.bootcdn.net/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://fonts.gstatic.com/">
<meta name="baidu-site-verification" content="1W34rVIdAO" />

<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous" integrity="sha256-eZrrJcwDc&#x2F;3uDhsdt61sL2oOBY362qM3lon1gyExkL0&#x3D; sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN sha512-SfTiTlX6kk+qitfevl&#x2F;7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+&#x2F;Sw&#x3D;&#x3D;">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro" />


<link rel="stylesheet" href="/css/style.css">

<link rel="manifest" href="/manifest.json">
<script type="module" src="/pwabuilder-sw-register.js"></script>
<!-- ç™¾åº¦ç»Ÿè®¡ -->
<script>
var _hmt = _hmt || [];
(function () {
var hm = document.createElement("script");
hm.src = "https://hm.baidu.com/hm.js?de1c4b02a9f8a51a6001797e045d3af9";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();
</script>
</head><body>
<div id="container">
<div id="wrap">
<header id="header">
<div id="banner"></div>
<div id="header-outer" class="outer">
<div id="header-title" class="inner">
<h1 id="logo-wrap">
<a href="/" id="logo">æ—¶ä»£æ®‹å…š</a>
</h1>

<h2 id="subtitle-wrap">
<a href="/" id="subtitle">éšæ‰‹ç¬”è®°</a>
</h2>

</div>
<div id="header-inner" class="inner">
<nav id="main-nav">
<a id="main-nav-toggle" class="nav-icon"></a>

<a class="main-nav-link" href="/">é¦–é¡µ</a>

<a class="main-nav-link" href="/archives">å½’æ¡£</a>

<a class="main-nav-link" href="/app">è”ç³»æˆ‘</a>

</nav>
<div id="search-form-wrap">
<div class="search-form"><input type="search" name="wd" class="search-form-input" placeholder="Search" list="search-datalist" autocomplete="false"/></div>

<input type="hidden" id="search-index-file" value="/search.json" />
<div id="search-form-datalist"></div>

</div>
<nav id="sub-nav">

<a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
</nav>
</div>
</div>
</header>
<div class="outer">
<section id="main">


<article id="post-csv-to-excel-file" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/07/14/csv-to-excel-file/" class="article-date">
  <time datetime="2022-07-14T05:15:25.000Z" itemprop="datePublished">2022-07-14</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/07/14/csv-to-excel-file/">CSVè½¬Excel</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<p>æœ¬ç¯‡æ˜¯æ¥ <a href="/2022/05/13/dotnet-core-build-standalone-executable-program/">ä¸Šä¸€ç¯‡æ–‡ç« </a>ï¼Œå…·ä½“åˆ° CSV è½¬ Excel è¿™ä¸€ä¸ªåœºæ™¯ä¸‹çš„å®é™…åº”ç”¨ã€‚</p>
<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>ä¸€èˆ¬ä»æ•°æ®åº“(æ¯”å¦‚ MySQL æˆ–è€… SQL Server)æˆ–è€…ä¸€äº›æ•°æ®å¹³å°ï¼ˆæ¯”å¦‚ Symantec æ—¥å¿—ï¼‰å¯¼å‡ºçš„ CSV æ–‡ä»¶ï¼ŒåŸºæœ¬éƒ½æ˜¯é‡‡ç”¨ <code>UTF-8</code> ç¼–ç ä¿å­˜çš„æ–‡ä»¶ã€‚ä½¿ç”¨ <code>UTF-8</code> ä¿å­˜çš„ CSV æ–‡ä»¶ä½œä¸ºé€šç”¨çš„ä¼ è¾“æ•°æ®åª’ä»‹ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ç„¶è€Œï¼Œæœ‰ä¸€äº›æœ‹å‹ï¼Œä½¿ç”¨ CSV æ–‡ä»¶å¹¶ä¸ä¸€å®šæ˜¯ç”¨æ¥ä¼ è¾“æ•°æ®çš„ï¼Œè€Œæ˜¯ç”¨æ¥æŸ¥çœ‹çš„ã€‚è¿™äº›æƒ…å†µä¸‹ï¼Œä»–ä»¬ä¼šå°è¯•ä½¿ç”¨ Microsoft Excel æ‰“å¼€ã€‚å“¦é¢ï¼Œé—®é¢˜æ¥äº†ï¼ŒExcel ä¸€èˆ¬ä¸ä¼šä¼˜å…ˆä½¿ç”¨ <code>UTF-8</code> ç¼–ç æ‰“å¼€ CSV æ–‡ä»¶ï¼Œç»“æœå°±æ˜¯ä¹±ç ã€‚</p>
<p>ä¸€èˆ¬çš„é€šç”¨è§£å†³åŠæ³•æ˜¯ï¼š</p>
<p><strong>ä½¿ç”¨ Excel çš„â€œæ•°æ®â€èœå•ï¼Œé€‰æ‹©â€œè‡ªæ–‡æœ¬â€ï¼Œç„¶åé€šè¿‡ä¸€äº›åˆ—çš„é¼ æ ‡ç‚¹ç‚¹ç‚¹æ“ä½œï¼ŒæŠŠ CSV æ–‡ä»¶åŠ è½½åˆ° Excel ä¸­ï¼ˆå…·ä½“ç»†èŠ‚è¯·å‚è€ƒå„å¤§æœç´¢å¼•æ“æˆ–åšå®¢ï¼‰ã€‚</strong></p>
<p><del>æœ¬ç¯‡å®Œï¼</del>ğŸ˜„</p>
<p>æ—¢ç„¶èº«ä¸ºç¨‹åºå‘˜ï¼Œæœ€ä¸èƒ½å®¹å¿çš„äº‹æƒ…å°±æ˜¯é‡å¤è‡ªå·±ï¼æœ€å–œæ¬¢åšçš„äº‹æƒ…å°±æ˜¯é‡å¤é€ è½®å­ã€‚ğŸ˜</p>
<h1 id="æŠ€æœ¯ç®€ä»‹"><a href="#æŠ€æœ¯ç®€ä»‹" class="headerlink" title="æŠ€æœ¯ç®€ä»‹"></a>æŠ€æœ¯ç®€ä»‹</h1><p>ç›´å…¥ä¸»é¢˜ï¼Œå¦‚ä½•ä½¿ç”¨ä»£ç ï¼Œæ‰èƒ½æŠŠ CSV è½¬æ¢æˆ Excel æ ¼å¼ï¼Ÿ</p>
<ol>
<li>é€‰æ‹©ç¼–ç¨‹è¯­è¨€</li>
<li>è¯»å– CSV æ–‡ä»¶æ–‡æœ¬å†…å®¹</li>
<li>æŒ‰ CSVï¼ˆComma Separated Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®</li>
<li>æŒ‰ Excel æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ Excel æ–‡ä»¶</li>
<li>ä¿å­˜ Excel æ–‡ä»¶</li>
</ol>
<h3 id="é€‰æ‹©ç¼–ç¨‹è¯­è¨€"><a href="#é€‰æ‹©ç¼–ç¨‹è¯­è¨€" class="headerlink" title="é€‰æ‹©ç¼–ç¨‹è¯­è¨€"></a>é€‰æ‹©ç¼–ç¨‹è¯­è¨€</h3><p>è¿™ä¸ªå°±æ— æ‰€è°“äº†ï¼Œæ—¢ç„¶æ˜¯é€ è½®å­ï¼Œå“ªä¸ªè¯­è¨€é¡ºæ‰‹å°±ç”¨å“ªä¸ªã€‚</p>
<h3 id="è¯»å–-CSV-æ–‡ä»¶å†…å®¹"><a href="#è¯»å–-CSV-æ–‡ä»¶å†…å®¹" class="headerlink" title="è¯»å– CSV æ–‡ä»¶å†…å®¹"></a>è¯»å– CSV æ–‡ä»¶å†…å®¹</h3><h3 id="æŒ‰-CSVï¼ˆComma-Separated-Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®"><a href="#æŒ‰-CSVï¼ˆComma-Separated-Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®" class="headerlink" title="æŒ‰ CSVï¼ˆComma Separated Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®"></a>æŒ‰ CSVï¼ˆComma Separated Valuesï¼‰æ–‡ä»¶è§„èŒƒï¼Œè½¬æ¢æˆäºŒç»´è¡¨æ ¼æ•°æ®</h3><p>ä¸Šé¢ä¸¤ä¸ªå†…å®¹æˆ‘æ”¾ä¸€èµ·ï¼Œä¸»è¦æ˜¯<del>æˆ‘æ‡’</del>è€ƒè™‘åˆ°è¯»å– CSV æ–‡ä»¶å®åœ¨æ˜¯å¤ªå¸¸è§äº†ï¼Œç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘è¿™é‡Œå¼•ç”¨çš„æ˜¯ <a href="">ClosedXML</a>ã€‚</p>
<h3 id="æŒ‰-Excel-æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ-Excel-æ–‡ä»¶"><a href="#æŒ‰-Excel-æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ-Excel-æ–‡ä»¶" class="headerlink" title="æŒ‰ Excel æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ Excel æ–‡ä»¶"></a>æŒ‰ Excel æ–‡ä»¶è§„èŒƒï¼ŒæŠŠäºŒç»´è¡¨æ ¼æ•°æ®è½¬æ¢æˆ Excel æ–‡ä»¶</h3><h3 id="ä¿å­˜-Excel-æ–‡ä»¶"><a href="#ä¿å­˜-Excel-æ–‡ä»¶" class="headerlink" title="ä¿å­˜ Excel æ–‡ä»¶"></a>ä¿å­˜ Excel æ–‡ä»¶</h3><p>åŒä¸Šï¼Œä¿å­˜æ•°æ®åˆ° Excel ä¹Ÿå¤ªç¨€ç–å¹³å¸¸äº†ã€‚æˆ‘è¿™é‡Œå¼•ç”¨çš„æ˜¯ <a href="">ClosedXML</a>ã€‚</p>
<p>ç»¼ä¸Šï¼Œæˆ‘ä»¬éœ€è¦åšçš„ï¼Œå°±éå¸¸å°‘äº†ï¼Œä»…å‰©ä¸€äº›ä¸šåŠ¡ä»£ç ã€‚</p>
<p><a href="https://github.com/ZXS66/csv2excel" target="_blank" rel="noopener">ç‚¹å‡»æ­¤å¤„</a> æŸ¥çœ‹æºä»£ç ã€‚</p>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/07/14/csv-to-excel-file/" data-id="cla8bpvmi001m9j8c9ajzahqq" data-title="CSVè½¬Excel" class="article-share-link">åˆ†äº«</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csv/" rel="tag">csv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/encoding/" rel="tag">encoding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/excel/" rel="tag">excel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gb2312/" rel="tag">gb2312</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unicode/" rel="tag">unicode</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/utf-8/" rel="tag">utf-8</a></li></ul>

</footer>
</div>

</article>



<article id="post-MySQL-regex-for-multi-bytes-character" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/06/25/MySQL-regex-for-multi-bytes-character/" class="article-date">
  <time datetime="2022-06-25T09:30:04.000Z" itemprop="datePublished">2022-06-25</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/06/25/MySQL-regex-for-multi-bytes-character/">MySQL æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒå¤šå­—èŠ‚å­—ç¬¦</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘åœ¨å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯éœ€è¦ä¸€äº›ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…ï¼Œè‡ªç„¶è€Œç„¶æƒ³åˆ°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼äº†ã€‚ç®€å•æœç´¢äº†ä¸€ä¸‹ï¼Œ<code>MySQL</code> ä¸­å¦‚ä½•ä½¿ç”¨æ­£åˆ™ï¼ŒåŸºæœ¬ä¸Šéƒ½ä»‹ç»ç”¨ <a href="https://dev.mysql.com/doc/refman/8.0/en/regexp.html" target="_blank" rel="noopener">REGEXP</a> å‡½æ•°ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸ªé™åˆ¶ï¼Œåœ¨ MySQL 8.0.4 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå®ƒæ˜¯æŒ‰å­—èŠ‚åŒ¹é…çš„ï¼Œè€Œä¸æ˜¯å­—ç¬¦ï¼æ¢å¥è¯è¯´ï¼Œå¯¹äºæ±‰å­—æˆ–è€… Emoji è¿™æ ·å¤šå­—èŠ‚çš„å­—ç¬¦ï¼Œå®ƒä¸æ”¯æŒï¼</p>
<blockquote>
<p>The REGEXP and RLIKE operators work in byte-wise fashion, so they are not multibyte safe and may produce unexpected results with multibyte character sets. In addition, these operators compare characters by their byte values and accented characters may not compare as equal even if a given collation treats them as equal. <a href="https://dev.mysql.com/doc/refman/5.6/en/regexp.html" target="_blank" rel="noopener"><a href="https://your-link.here" target="_blank" rel="noopener"><fa-link/></a></a></p>
</blockquote>
<p>æ‰€ä»¥ï¼Œåœ¨ MySQL 8.0.4 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•é’ˆå¯¹å¤šå­—èŠ‚çš„å­—ç¬¦ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å‘¢ï¼Ÿ</p>
<p>å‡çº§ MySQLï¼Ÿå¥½å§ï¼Œå½“æˆ‘æ²¡é—®ã€‚ğŸ™Š</p>
<p>é’ˆå¯¹ä¸€ä¸ªçº¿ä¸Šçš„ MySQLï¼Œå¦‚æœè¦å¿…é¡»è¦å®ç°ä¸šåŠ¡é€»è¾‘ï¼Œåˆä¸èƒ½å˜æ›´ MySQLï¼Œæœ‰ä»€ä¹ˆå¥½çš„åŠæ³•ï¼Ÿ</p>
<p>ä¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œé‡‡ç”¨ IF ELSE è¯­å¥æ›¿ä»£ï¼Ÿä¹Ÿä¸æ˜¯ä¸å¯ä»¥ï¼Œä½†æ˜¯é€»è¾‘ç¨è´Ÿè´£ä¸€ç‚¹ï¼ŒSQL è„šæœ¬å°±å¼€å§‹å˜å¾—å†—é•¿ã€æ€§èƒ½ä½ä¸‹ä¸”éš¾ä»¥ç»´æŠ¤äº†ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±çš„ç»éªŒæ€»ç»“ï¼Œä»…ä¾›å‚è€ƒã€‚</p>
<h1 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h1><p>æ—¢ç„¶ MySQL 8.0.4 ä¹‹å‰çš„ REGEXP åªèƒ½æ”¯æŒå•å­—èŠ‚ï¼Œé‚£æˆ‘æŠŠå¤šå­—èŠ‚å­—ç¬¦éƒ½æ›¿æ¢æˆå•å­—èŠ‚å­—ç¬¦å†æ­£åˆ™åŒ¹é…ä¸å°±è¡Œäº†ï¼Ÿ<a href="https://dev.mysql.com/doc/refman/8.0/en/replace.html" target="_blank" rel="noopener">REPLACE</a> å‡½æ•°æ˜¯æ”¯æŒå¤šå­—èŠ‚çš„ã€‚</p>
<h1 id="æ”¾ç "><a href="#æ”¾ç " class="headerlink" title="æ”¾ç "></a>æ”¾ç </h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">USE</span> <span class="string">`project_otis2019`</span>$$</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`fx_regexp_over_multi_characters_sample`</span>$$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DEFINER=<span class="string">`zxs66`</span>@<span class="string">`%`</span> <span class="keyword">FUNCTION</span> <span class="string">`fx_regexp_over_multi_characters_sample`</span>(<span class="keyword">content</span> <span class="built_in">TEXT</span>) <span class="keyword">RETURNS</span> <span class="built_in">TINYINT</span>(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">COMMENT</span> <span class="string">'check if given content match specific regular expression'</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">DECLARE</span> normalized_content <span class="built_in">TEXT</span>;</span><br><span class="line">	<span class="keyword">SET</span> normalized_content=<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(</span><br><span class="line">					<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(</span><br><span class="line">						<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">content</span>,<span class="string">'æ°´æœ'</span>,<span class="string">'`'</span>),<span class="string">'è”¬èœ'</span>,<span class="string">'`'</span>),<span class="string">'ç‰›å¥¶'</span>,<span class="string">'`'</span>),<span class="string">'ç‰›ç¾Šè‚‰'</span>,<span class="string">'`'</span>),<span class="string">'æ‚ç²®'</span>,<span class="string">'`'</span>),</span><br><span class="line">						<span class="string">'ï¼Œ'</span>,<span class="string">','</span>),<span class="string">'ï¼›'</span>,<span class="string">','</span>),<span class="string">'ã€‚'</span>,<span class="string">','</span>),</span><br><span class="line">						<span class="string">'ç§æ¤'</span>,<span class="string">'@'</span>),<span class="string">'è¿è¾“'</span>,<span class="string">'@'</span>),<span class="string">'å‚¨è—'</span>,<span class="string">'@'</span>),<span class="string">'é”€å”®'</span>,<span class="string">'@'</span>),<span class="string">'æ£€éªŒ'</span>,<span class="string">'@'</span>),<span class="string">'ä¿ä¾›'</span>,<span class="string">'@'</span>),<span class="string">'æ‰¹å‘'</span>,<span class="string">'@'</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">-- the regular expression below can be revised based on your actual bussiness requirements.</span></span><br><span class="line">	RETURN normalized_content REGEXP '`[^,;\.]*@' OR normalized_content REGEXP '@[^,;\.]*`'; </span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h1 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h1><p>ä¸Šè¿°è„šæœ¬ä»…æä¾›ä¸€ç§æ€è·¯ï¼Œè‚¯å®šä¸æ˜¯æœ€ä¼˜è§£ï¼Œè¿˜å­˜åœ¨è¯¸å¤šå¼Šç«¯ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é—®é¢˜å°±æ˜¯ï¼Œæ›¿æ¢æ‰çš„å•å­—èŠ‚å­—ç¬¦ä¸èƒ½ä¸åŸæ¥çš„æ–‡ä»¶å†…å®¹æœ‰å†²çªã€‚å¦‚æœæœ‰ä¸åŒæ„è§ï¼Œè¿˜è¯·ä¸åèµæ•™ã€‚</p>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/06/25/MySQL-regex-for-multi-bytes-character/" data-id="cla8bpvmb00129j8cd7vn2pi3" data-title="MySQL æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒå¤šå­—èŠ‚å­—ç¬¦" class="article-share-link">åˆ†äº«</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multi-bytes/" rel="tag">multi-bytes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/regex/" rel="tag">regex</a></li></ul>

</footer>
</div>

</article>



<article id="post-CSharp-bulk-insert-records-into-MySQL" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/05/20/CSharp-bulk-insert-records-into-MySQL/" class="article-date">
  <time datetime="2022-05-20T06:58:42.000Z" itemprop="datePublished">2022-05-20</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/05/20/CSharp-bulk-insert-records-into-MySQL/">C# æ‰¹é‡æ’å…¥è®°å½•è‡³ MySQL</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<p>æœ¬ä»¥ä¸ºï¼Œ<code>C#</code> æ‰¹é‡æ’å…¥è®°å½•è‡³ <code>MySQL</code> è¿™ä¸ªæƒ…å†µåº”è¯¥å¾ˆæ™®éï¼Œæ‰¹é‡æ’å…¥çš„ä»£ç å¾ˆç®€å•ï¼Œå°±åƒæ‰¹é‡æ’å…¥ <code>SQL Server</code> ä¸€æ · (ä½¿ç”¨ <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/bulk-copy-operations-in-sql-server" target="_blank" rel="noopener">SQLBulkCopy</a>)ã€‚ç»“æœï¼šæˆ‘è‰ç‡äº†ã€‚</p>
<p>ä¸€èˆ¬ <code>.NET</code> å¼€å‘äººå‘˜ï¼Œä½¿ç”¨ <a href="https://www.nuget.org/packages/MySql.Data" target="_blank" rel="noopener">MySql.Data</a> è¿™ä¸ªå®˜æ–¹åŒ…æ¥è¿æ¥ <code>MySQL</code>ã€‚è¿™ä¸ªåŒ…å¾ˆä¼˜ç§€ï¼Œèƒ½å¤Ÿæ»¡è¶³ç»å¤§å¤šæ•°çš„é—®é¢˜ï¼Œä½†ä¸åŒ…æ‹¬æ‰¹é‡æ’å…¥ï¼ˆå¦‚æœæœ‰å“ªä½å¤§ç‰›çŸ¥é“å®˜æ–¹çš„æ¨èåšæ³•ï¼Œçƒ¦è¯·å‘ŠçŸ¥ï¼Œæå‰æ„Ÿè°¢ï¼ï¼‰ã€‚å”¯ä¸€å’Œæ‰¹é‡æ’å…¥(bulk insert)å¯èƒ½æœ‰å…³è”çš„æ˜¯ <a href="https://dev.mysql.com/doc/dev/connector-net/6.10/html/T_MySql_Data_MySqlClient_MySqlCommandBuilder.htm" target="_blank" rel="noopener">MySqlBulkLoader</a>ï¼Œä½†è¿™ä¸ªç±»çš„ä½¿ç”¨åœºæ™¯æ˜¯ä» csv æ–‡ä»¶æ‰¹é‡å¯¼å…¥ï¼Œç±»ä¼¼äºä»¥ä¸‹å‘½ä»¤ï¼š<code>LOAD DATA INFILE &#39;/tmp/data.csv&#39; INTO TABLE bulk FIELDS TERMINATED BY &#39;,&#39; ENCLOSED BY &#39;\&quot;&#39; LINES TERMINATED BY &#39;\n&#39;</code>ã€‚</p>
<p>ä½†å…¶å®ï¼Œ<code>.NET</code> å¼€å‘äººå‘˜åœ¨æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æŠŠè¿è¡Œæ—¶çš„åˆ—è¡¨æ‰¹é‡æ’å…¥åˆ°æ•°æ®åº“ï¼Œæ¯”å¦‚ <code>IEnumerable&lt;object&gt;</code>ã€‚ç½‘ä¸Šç¨å¾®æ‰¾äº†ä¸€é€šï¼Œå‘ç°æ²¡æœ‰ç°æˆçš„å°è£…ç±»æˆ–å¯ä¾›å‚è€ƒçš„ä»£ç ã€‚æ²¡åŠæ³•äº†ï¼Œè‡ªå·±åŠ¨æ‰‹å§ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘ç®€å•å°è£…çš„ä»£ç ï¼Œæ‹¿èµ°ä¸è°¢ï¼š</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> handy functions for inquiring mysql</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MySQLCommonHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> bulk insert data into database</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name="T"&gt;</span>data type<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="data"&gt;</span>the data to be inserted into database<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="tableName"&gt;</span>destination table name<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="connectionString"&gt;</span>connection string of MySQL<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref="ArgumentNullException"&gt;</span><span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> BulkInsert&lt;T&gt;(IEnumerable&lt;T&gt; data, <span class="keyword">string</span> tableName, <span class="keyword">string</span> connectionString)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (CommonUtility.IsNullOrEmptyList(data))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">// throw new ArgumentNullException(nameof(dt));</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrWhiteSpace(tableName))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(tableName));</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrEmpty(connectionString))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(connectionString));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// init the DataTable for bulk inserting</span></span><br><span class="line">        <span class="keyword">var</span> table = <span class="keyword">new</span> DataTable(tableName);</span><br><span class="line">        <span class="keyword">var</span> props = <span class="keyword">typeof</span>(T).GetProperties();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> props)</span><br><span class="line">        &#123;</span><br><span class="line">            table.Columns.Add(<span class="keyword">new</span> DataColumn(prop.Name, prop.PropertyType));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="keyword">var</span> d <span class="keyword">in</span> data)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> row = table.NewRow();</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="keyword">var</span> prop <span class="keyword">in</span> props)</span><br><span class="line">            &#123;</span><br><span class="line">                row[prop.Name] = prop.GetValue(d, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            table.Rows.Add(row);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> (MySqlConnection connection = <span class="keyword">new</span> MySqlConnection(connectionString))</span><br><span class="line">        &#123;</span><br><span class="line">            connection.Open();</span><br><span class="line">            <span class="keyword">using</span> (MySqlCommand cmd = connection.CreateCommand())</span><br><span class="line">            &#123;</span><br><span class="line">                cmd.CommandText = <span class="string">$"SELECT * FROM <span class="subst">&#123;tableName&#125;</span> LIMIT 0"</span>;</span><br><span class="line">                <span class="keyword">using</span> (MySqlDataAdapter adapter = <span class="keyword">new</span> MySqlDataAdapter(cmd))</span><br><span class="line">                &#123;</span><br><span class="line">                    adapter.UpdateBatchSize = <span class="number">8192</span>;</span><br><span class="line">                    <span class="keyword">using</span> (MySqlCommandBuilder cb = <span class="keyword">new</span> MySqlCommandBuilder(adapter))</span><br><span class="line">                    &#123;</span><br><span class="line">                        adapter.InsertCommand = cb.GetInsertCommand();</span><br><span class="line">                        adapter.Fill(table);</span><br><span class="line">                        <span class="comment">// Without the MySqlCommandBuilder this line would fail</span></span><br><span class="line">                        <span class="keyword">var</span> rows = adapter.Update(table);</span><br><span class="line">                        <span class="keyword">return</span> rows &gt; <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><ul>
<li><a href="https://social.msdn.microsoft.com/forums/en-US/a8c1e923-e2d1-439c-a114-2b734c9e7fd4/bulk-insert-aspnet-datatable-to-mysql" target="_blank" rel="noopener">Bulk Insert asp.net Datatable to Mysql</a></li>
<li><a href="https://mysqly.com/educate/insert-bulk-into-mysql" target="_blank" rel="noopener">Insert large amounts of data into Mysql</a></li>
</ul>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/05/20/CSharp-bulk-insert-records-into-MySQL/" data-id="cla8bpvm2000e9j8c2mda98l2" data-title="C# æ‰¹é‡æ’å…¥è®°å½•è‡³ MySQL" class="article-share-link">åˆ†äº«</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bulk-insert/" rel="tag">bulk insert</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csharp/" rel="tag">csharp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql-connector/" rel="tag">mysql.connector</a></li></ul>

</footer>
</div>

</article>




<nav id="page-nav">

<span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/2/">ä¸‹ä¸€é¡µ &gt;</a>
</nav>

<style>
.article {max-height: 123vh;overflow: hidden;position: relative;}
.article.unfold {max-height: initial;}
.article .more {position: absolute;bottom: 0;padding: 3em;cursor: pointer;text-align: center;width: 100%;background: linear-gradient(rgba(0, 0, 0, 0), silver);color: white;box-sizing: border-box;}
.article.unfold .more {display: none;}
</style>
<script>
(function () {
// show more
const moreText = '<i class="fa fa-arrow-circle-down" aria-hidden="true"></i> ' + "æ›´å¤š";
const articles = document.getElementsByClassName('article');
for (let i = 0; i < articles.length; i++) {
const $more = document.createElement('div');
$more.classList.add('more');$more.innerHTML = moreText;
$more.onclick = function (evt) {
const $src = evt.target || evt.srcElement;$src.parentElement.classList.add('unfold');
};
articles[i].appendChild($more);
}})();
</script>
</section>

</div>
<footer id="footer">

<div class="outer"><div id="footer-info" class="inner">&copy; 2022 æ—¶ä»£æ®‹å…š<br>
Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></div>
</div></footer>
</div>
<nav id="mobile-nav">

<a href="/" class="mobile-nav-link">home</a>

<a href="/archives" class="mobile-nav-link">archives</a>

<a href="/app" class="mobile-nav-link">contact</a>

</nav>
<!--

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/2.0.3/jquery.min.js" crossorigin="anonymous" integrity="sha256-pXtSQrmprcTB74RsNlFHuJxHK5zXcPrOMx78uWU0ayU&#x3D; sha384-ECTndYny330R2jlSXBiZkdXzAVi0Z&#x2F;iDXJTwV6cp39HECmalqg6+b2sFZFf&#x2F;Y2m6 sha512-epzJ9ms+0Pq+zFMrG1lXVNvjEXgtfKx9iuEWqz3hmbaU2m&#x2F;Dp1pcmpYzuSdDLqX6PMIjzMOyGFwMc+SkgFhMFg&#x3D;&#x3D;"></script>

-->

<script src="/js/script.js" async></script>

</div>
<script>
(function () {
// append image-caption
const images = document.querySelectorAll('article img');
for (let j = 0; j < images.length; j++) {
const $img = images[j];
const altText = $img.getAttribute('alt');
if (altText && altText.length && !$img.classList.contains('inline')) {
const $imgCaption = document.createElement('div');
$imgCaption.classList.add('img-caption');
$imgCaption.innerText = $img.getAttribute('alt');
$img.parentNode.insertBefore($imgCaption, $img.nextSibling);
}}})();
</script>
</body></html>