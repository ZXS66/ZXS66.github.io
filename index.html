<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<title>时代残党</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="icon" href="/favicon.png">
<meta property="og:type" content="website">
<meta property="og:title" content="时代残党">
<meta property="og:url" content="https://zxs66.github.io/">
<meta property="og:site_name" content="时代残党">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="时代残党">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="Angular">
<meta property="article:tag" content="NodeJS">
<meta property="article:tag" content="SQL">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="ASP.NET">
<meta property="article:tag" content="Full Stack">
<meta name="twitter:card" content="summary">
<link rel="dns-prefetch" href="https://cdn.bootcdn.net/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://fonts.gstatic.com/">
<meta name="baidu-site-verification" content="1W34rVIdAO" />

<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous" integrity="sha256-eZrrJcwDc&#x2F;3uDhsdt61sL2oOBY362qM3lon1gyExkL0&#x3D; sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN sha512-SfTiTlX6kk+qitfevl&#x2F;7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+&#x2F;Sw&#x3D;&#x3D;">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro" />


<link rel="stylesheet" href="/css/style.css">

<link rel="manifest" href="/manifest.json">
<script type="module" src="/pwabuilder-sw-register.js"></script>
<!-- 百度统计 -->
<script>
var _hmt = _hmt || [];
(function () {
var hm = document.createElement("script");
hm.src = "https://hm.baidu.com/hm.js?de1c4b02a9f8a51a6001797e045d3af9";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();
</script>
</head><body>
<div id="container">
<div id="wrap">
<header id="header">
<div id="banner"></div>
<div id="header-outer" class="outer">
<div id="header-title" class="inner">
<h1 id="logo-wrap">
<a href="/" id="logo">时代残党</a>
</h1>

<h2 id="subtitle-wrap">
<a href="/" id="subtitle">随手笔记</a>
</h2>

</div>
<div id="header-inner" class="inner">
<nav id="main-nav">
<a id="main-nav-toggle" class="nav-icon"></a>

<a class="main-nav-link" href="/">首页</a>

<a class="main-nav-link" href="/archives">归档</a>

<a class="main-nav-link" href="/app">联系我</a>

</nav>
<div id="search-form-wrap">
<div class="search-form"><input type="search" name="wd" class="search-form-input" placeholder="Search" list="search-datalist" autocomplete="false"/></div>

<input type="hidden" id="search-index-file" value="/search.json" />
<div id="search-form-datalist"></div>

</div>
<nav id="sub-nav">

<a id="nav-search-btn" class="nav-icon" title="搜索"></a>
</nav>
</div>
</div>
</header>
<div class="outer">
<section id="main">


<article id="post-setup-wsl-development-environment" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/11/10/setup-wsl-development-environment/" class="article-date">
  <time datetime="2022-11-10T13:50:30.000Z" itemprop="datePublished">2022-11-10</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/11/10/setup-wsl-development-environment/">配置 WSL 开发环境</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><h5 id="启用虚拟化和WSL"><a href="#启用虚拟化和WSL" class="headerlink" title="启用虚拟化和WSL"></a>启用虚拟化和WSL</h5><p><img src="/images/setup-wsl-development-environment/turn-on-or-off-windows-features.jpg" alt="启用或关闭Windows功能"></p>
<p>完成之后需要重启。</p>
<h5 id="启用WSL"><a href="#启用WSL" class="headerlink" title="启用WSL"></a>启用WSL</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --install</span><br></pre></td></tr></table></figure>
<p>完成之后<em>可能</em>需要重启。</p>
<h5 id="安装Windows-Terminal"><a href="#安装Windows-Terminal" class="headerlink" title="安装Windows Terminal"></a>安装Windows Terminal</h5><p>在 Microsoft Store （应用商城）中搜索 Windows Terminal 即可一键安装，此处省。</p>
<h5 id="安装Ubuntu"><a href="#安装Ubuntu" class="headerlink" title="安装Ubuntu"></a>安装Ubuntu</h5><p>有多种方式可以安装 Ubuntu。最简单的方式，就是和上一步一样，在 Microsoft Store （应用商城）中搜索 Ubuntu 即可一键安装，此处省。</p>
<h5 id="配置-apt-国内软件源镜像"><a href="#配置-apt-国内软件源镜像" class="headerlink" title="配置 apt 国内软件源镜像"></a>配置 apt 国内软件源镜像</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.20221110.bak <span class="comment"># 备份是个好习惯</span></span><br><span class="line">sudo vim /etc/apt/sources.list <span class="comment"># 替换国内镜像源以加速，根据 Ubuntu 不同版本号，选择不同的路径</span></span><br></pre></td></tr></table></figure>

<p>因为我在上海，使用的又是 Ubuntu 22.04，所以我的配置如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-updates main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-updates main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-backports main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-backports main restricted universe multiverse</span><br><span class="line">deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-security main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-security main restricted universe multiverse</span><br><span class="line"></span><br><span class="line"># deb https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-proposed main restricted universe multiverse</span><br><span class="line"># deb-src https:&#x2F;&#x2F;mirror.sjtu.edu.cn&#x2F;ubuntu&#x2F; jammy-proposed main restricted universe multiverse</span><br></pre></td></tr></table></figure>

<h5 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h5><p>安装完成之后，打开 Windows Terminal，选择 Ubuntu：</p>
<p><img src="/images/setup-wsl-development-environment/windows-terminal.jpg" alt="Windows Terminal"></p>
<p>第一次打开会提示设置用户名密码（超级用户权限）。</p>
<h5 id="Windows-环境必要软件安装"><a href="#Windows-环境必要软件安装" class="headerlink" title="Windows 环境必要软件安装"></a>Windows 环境必要软件安装</h5><p>根据各开发者技术栈不同，需要安装的软件会有所不同。包括但不限于：<a href="https://www.docker.com/products/docker-desktop/" target="_blank" rel="noopener">Docker Desktop</a>、<a href="https://code.visualstudio.com" target="_blank" rel="noopener">Visual Studio Code</a>、<a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack" target="_blank" rel="noopener">Remote Development Extension Pack</a></p>
<h5 id="WSL-环境必要软件安装"><a href="#WSL-环境必要软件安装" class="headerlink" title="WSL 环境必要软件安装"></a>WSL 环境必要软件安装</h5><p>根据各开发者技术栈不同，需要安装的软件会有所不同。包括但不限于：<a href="https://git-scm.com/download/linux" target="_blank" rel="noopener">git</a>、<a href="https://nodejs.org" target="_blank" rel="noopener">node.js</a>、<a href="https://www.python.org/downloads/" target="_blank" rel="noopener">python</a></p>
<h5 id="GitHub-加速"><a href="#GitHub-加速" class="headerlink" title="GitHub 加速"></a>GitHub 加速</h5><p>其实，现在好多办法都可以加速访问 <a href="https://github.com" target="_blank" rel="noopener">GitHub</a>，我这里介绍一种特别原始的办法，就是修改 hosts 文件。</p>
<ol>
<li>以管理员权限，打开记事本</li>
<li>记事本中打开 <code>C:\Windows\System32\drivers\etc\hosts</code> 文件</li>
<li>添加以下 IP 映射：<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 需要定期更新如下代码</span></span><br><span class="line"><span class="comment"># New！欢迎使用基于DNS的新方案</span></span><br><span class="line"><span class="comment"># https://gitlab.com/ineo6/hosts/-/raw/master/next-hosts</span></span><br><span class="line"><span class="comment"># 地址可能会变动，请务必关注GitHub、Gitlab获取最新消息</span></span><br><span class="line"><span class="comment"># 也可以关注公众号：湖中剑，保证不迷路</span></span><br><span class="line"><span class="comment"># GitHub Host Start</span></span><br><span class="line"></span><br><span class="line">140.82.114.3                 central.github.com</span><br><span class="line">140.82.114.3                 assets-cdn.github.com</span><br><span class="line">151.101.1.6                  github.map.fastly.net</span><br><span class="line">151.101.1.6                  github.global.ssl.fastly.net</span><br><span class="line">140.82.114.3                 gist.github.com</span><br><span class="line">185.199.108.153              github.io</span><br><span class="line">140.82.114.3                 github.com</span><br><span class="line">140.82.114.3                 api.github.com</span><br><span class="line">140.82.114.3                 codeload.github.com</span><br><span class="line">72.21.206.80                 github-cloud.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-com.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-production-release-asset-2e65be.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-production-user-asset-6210df.s3.amazonaws.com</span><br><span class="line">72.21.206.80                 github-production-repository-file-5c1aeb.s3.amazonaws.com</span><br><span class="line">185.199.108.153              githubstatus.com</span><br><span class="line">140.82.113.18                github.community</span><br><span class="line">140.82.114.3                 raw.github.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># Please Star : https://github.com/ineo6/hosts</span></span><br><span class="line"><span class="comment"># Mirror Repo : https://gitlab.com/ineo6/hosts</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Update at: 2022-11-10 16:20:33</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GitHub Host End</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>当然，也有其他的提供最新 hosts（比如 <a href="https://raw.hellogithub.com/hosts" target="_blank" rel="noopener">https://raw.hellogithub.com/hosts</a> ) 或者自动 switchhosts（比如 <a href="https://github.com/oldj/SwitchHosts" target="_blank" rel="noopener">https://github.com/oldj/SwitchHosts</a> ），或者其他科学上网方式，感兴趣的请自行搜索。</p>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul>
<li><a href="https://learn.microsoft.com/en-us/windows/wsl/install" target="_blank" rel="noopener"><i class="fa fa-windows" aria-hidden="true"></i>Install Linux on Windows with WSL</a></li>
<li><a href="https://mirrors.sjtug.sjtu.edu.cn/docs/ubuntu" target="_blank" rel="noopener">上海交通大学 Linux 用户组 软件源镜像服务</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/wsl/setup/environment" target="_blank" rel="noopener"><i class="fa fa-windows" aria-hidden="true"></i>Set up a WSL development environment</a></li>
<li><a href="https://ineo6.github.io/hosts/" target="_blank" rel="noopener"><i class="fa fa-github" aria-hidden="true"></i>GitHub Hosts | hosts</a></li>
</ul>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/11/10/setup-wsl-development-environment/" data-id="clbrr63ho00c7m08cdh1326cc" data-title="配置 WSL 开发环境" class="article-share-link">分享</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wsl/" rel="tag">wsl</a></li></ul>

</footer>
</div>

</article>



<article id="post-csv-to-excel-file" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/07/14/csv-to-excel-file/" class="article-date">
  <time datetime="2022-07-14T05:15:25.000Z" itemprop="datePublished">2022-07-14</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/07/14/csv-to-excel-file/">CSV转Excel</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<p>本篇是接 <a href="/2022/05/13/dotnet-core-build-standalone-executable-program/">上一篇文章</a>，具体到 CSV 转 Excel 这一个场景下的实际应用。</p>
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>一般从数据库(比如 MySQL 或者 SQL Server)或者一些数据平台（比如 Symantec 日志）导出的 CSV 文件，基本都是采用 <code>UTF-8</code> 编码保存的文件。使用 <code>UTF-8</code> 保存的 CSV 文件作为通用的传输数据媒介，一般来说，是没有问题的。然而，有一些朋友，使用 CSV 文件并不一定是用来传输数据的，而是用来查看的。这些情况下，他们会尝试使用 Microsoft Excel 打开。哦额，问题来了，Excel 一般不会优先使用 <code>UTF-8</code> 编码打开 CSV 文件，结果就是乱码。</p>
<p>一般的通用解决办法是：</p>
<p><strong>使用 Excel 的“数据”菜单，选择“自文本”，然后通过一些列的鼠标点点点操作，把 CSV 文件加载到 Excel 中（具体细节请参考各大搜索引擎或博客）。</strong></p>
<p><del>本篇完！</del>😄</p>
<p>既然身为程序员，最不能容忍的事情就是重复自己！最喜欢做的事情就是重复造轮子。😏</p>
<h1 id="技术简介"><a href="#技术简介" class="headerlink" title="技术简介"></a>技术简介</h1><p>直入主题，如何使用代码，才能把 CSV 转换成 Excel 格式？</p>
<ol>
<li>选择编程语言</li>
<li>读取 CSV 文件文本内容</li>
<li>按 CSV（Comma Separated Values）文件规范，转换成二维表格数据</li>
<li>按 Excel 文件规范，把二维表格数据转换成 Excel 文件</li>
<li>保存 Excel 文件</li>
</ol>
<h3 id="选择编程语言"><a href="#选择编程语言" class="headerlink" title="选择编程语言"></a>选择编程语言</h3><p>这个就无所谓了，既然是造轮子，哪个语言顺手就用哪个。</p>
<h3 id="读取-CSV-文件内容"><a href="#读取-CSV-文件内容" class="headerlink" title="读取 CSV 文件内容"></a>读取 CSV 文件内容</h3><h3 id="按-CSV（Comma-Separated-Values）文件规范，转换成二维表格数据"><a href="#按-CSV（Comma-Separated-Values）文件规范，转换成二维表格数据" class="headerlink" title="按 CSV（Comma Separated Values）文件规范，转换成二维表格数据"></a>按 CSV（Comma Separated Values）文件规范，转换成二维表格数据</h3><p>上面两个内容我放一起，主要是<del>我懒</del>考虑到读取 CSV 文件实在是太常见了，网上已经有很多成熟的解决方案。我这里引用的是 <a href="">ClosedXML</a>。</p>
<h3 id="按-Excel-文件规范，把二维表格数据转换成-Excel-文件"><a href="#按-Excel-文件规范，把二维表格数据转换成-Excel-文件" class="headerlink" title="按 Excel 文件规范，把二维表格数据转换成 Excel 文件"></a>按 Excel 文件规范，把二维表格数据转换成 Excel 文件</h3><h3 id="保存-Excel-文件"><a href="#保存-Excel-文件" class="headerlink" title="保存 Excel 文件"></a>保存 Excel 文件</h3><p>同上，保存数据到 Excel 也太稀疏平常了。我这里引用的是 <a href="">ClosedXML</a>。</p>
<p>综上，我们需要做的，就非常少了，仅剩一些业务代码。</p>
<p><a href="https://github.com/ZXS66/csv2excel" target="_blank" rel="noopener">点击此处</a> 查看源代码。</p>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/07/14/csv-to-excel-file/" data-id="clbrr63g0002bm08c3l7056xe" data-title="CSV转Excel" class="article-share-link">分享</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/asp-net-core/" rel="tag">asp.net core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csv/" rel="tag">csv</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/encoding/" rel="tag">encoding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/excel/" rel="tag">excel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gb2312/" rel="tag">gb2312</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unicode/" rel="tag">unicode</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/utf-8/" rel="tag">utf-8</a></li></ul>

</footer>
</div>

</article>



<article id="post-MySQL-regex-for-multi-bytes-character" class="article article-type-post" itemscope itemprop="blogPost">
<div class="article-meta">
<a href="/2022/06/25/MySQL-regex-for-multi-bytes-character/" class="article-date">
  <time datetime="2022-06-25T09:30:04.000Z" itemprop="datePublished">2022-06-25</time>
</a>

</div>
<div class="article-inner">


<header class="article-header">
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/06/25/MySQL-regex-for-multi-bytes-character/">MySQL 正则表达式支持多字节字符</a>
    </h1>
  
</header>

<div class="article-entry" itemprop="articleBody">
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>最近在工作中遇到一个小问题，就是需要一些简单的字符串匹配，自然而然想到使用正则表达式了。简单搜索了一下，<code>MySQL</code> 中如何使用正则，基本上都介绍用 <a href="https://dev.mysql.com/doc/refman/8.0/en/regexp.html" target="_blank" rel="noopener">REGEXP</a> 函数。</p>
<p>但是，这个函数有个限制，在 MySQL 8.0.4 之前的版本，它是按字节匹配的，而不是字符！换句话说，对于汉字或者 Emoji 这样多字节的字符，它不支持！</p>
<blockquote>
<p>The REGEXP and RLIKE operators work in byte-wise fashion, so they are not multibyte safe and may produce unexpected results with multibyte character sets. In addition, these operators compare characters by their byte values and accented characters may not compare as equal even if a given collation treats them as equal. <a href="https://dev.mysql.com/doc/refman/5.6/en/regexp.html" target="_blank" rel="noopener"><a href="https://your-link.here" target="_blank" rel="noopener"><fa-link/></a></a></p>
</blockquote>
<p>所以，在 MySQL 8.0.4 之前的版本，我们该如何针对多字节的字符使用正则表达式呢？</p>
<p>升级 MySQL？好吧，当我没问。🙊</p>
<p>针对一个线上的 MySQL，如果要必须要实现业务逻辑，又不能变更 MySQL，有什么好的办法？</p>
<p>不用正则表达式，采用 IF ELSE 语句替代？也不是不可以，但是逻辑稍负责一点，SQL 脚本就开始变得冗长、性能低下且难以维护了。</p>
<p>以下是我自己的经验总结，仅供参考。</p>
<h1 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h1><p>既然 MySQL 8.0.4 之前的 REGEXP 只能支持单字节，那我把多字节字符都替换成单字节字符再正则匹配不就行了？<a href="https://dev.mysql.com/doc/refman/8.0/en/replace.html" target="_blank" rel="noopener">REPLACE</a> 函数是支持多字节的。</p>
<h1 id="放码"><a href="#放码" class="headerlink" title="放码"></a>放码</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">USE</span> <span class="string">`project_otis2019`</span>$$</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`fx_regexp_over_multi_characters_sample`</span>$$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DEFINER=<span class="string">`zxs66`</span>@<span class="string">`%`</span> <span class="keyword">FUNCTION</span> <span class="string">`fx_regexp_over_multi_characters_sample`</span>(<span class="keyword">content</span> <span class="built_in">TEXT</span>) <span class="keyword">RETURNS</span> <span class="built_in">TINYINT</span>(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">COMMENT</span> <span class="string">'check if given content match specific regular expression'</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">DECLARE</span> normalized_content <span class="built_in">TEXT</span>;</span><br><span class="line">	<span class="keyword">SET</span> normalized_content=<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(</span><br><span class="line">					<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(</span><br><span class="line">						<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">REPLACE</span>(<span class="keyword">content</span>,<span class="string">'水果'</span>,<span class="string">'`'</span>),<span class="string">'蔬菜'</span>,<span class="string">'`'</span>),<span class="string">'牛奶'</span>,<span class="string">'`'</span>),<span class="string">'牛羊肉'</span>,<span class="string">'`'</span>),<span class="string">'杂粮'</span>,<span class="string">'`'</span>),</span><br><span class="line">						<span class="string">'，'</span>,<span class="string">','</span>),<span class="string">'；'</span>,<span class="string">','</span>),<span class="string">'。'</span>,<span class="string">','</span>),</span><br><span class="line">						<span class="string">'种植'</span>,<span class="string">'@'</span>),<span class="string">'运输'</span>,<span class="string">'@'</span>),<span class="string">'储藏'</span>,<span class="string">'@'</span>),<span class="string">'销售'</span>,<span class="string">'@'</span>),<span class="string">'检验'</span>,<span class="string">'@'</span>),<span class="string">'保供'</span>,<span class="string">'@'</span>),<span class="string">'批发'</span>,<span class="string">'@'</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">-- the regular expression below can be revised based on your actual bussiness requirements.</span></span><br><span class="line">	RETURN normalized_content REGEXP '`[^,;\.]*@' OR normalized_content REGEXP '@[^,;\.]*`'; </span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h1 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h1><p>上述脚本仅提供一种思路，肯定不是最优解，还存在诸多弊端，其中一个显而易见的问题就是，替换掉的单字节字符不能与原来的文件内容有冲突。如果有不同意见，还请不吝赐教。</p>

</div>
<footer class="article-footer">
<a data-url="https://zxs66.github.io/2022/06/25/MySQL-regex-for-multi-bytes-character/" data-id="clbrr63fm000ym08c6qqda64d" data-title="MySQL 正则表达式支持多字节字符" class="article-share-link">分享</a>


  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multi-bytes/" rel="tag">multi-bytes</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/regex/" rel="tag">regex</a></li></ul>

</footer>
</div>

</article>




<nav id="page-nav">

<span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/2/">下一页 &gt;</a>
</nav>

<style>
.article {max-height: 123vh;overflow: hidden;position: relative;}
.article.unfold {max-height: initial;}
.article .more {position: absolute;bottom: 0;padding: 3em;cursor: pointer;text-align: center;width: 100%;background: linear-gradient(rgba(0, 0, 0, 0), silver);color: white;box-sizing: border-box;}
.article.unfold .more {display: none;}
</style>
<script>
(function () {
// show more
const moreText = '<i class="fa fa-arrow-circle-down" aria-hidden="true"></i> ' + "更多";
const articles = document.getElementsByClassName('article');
for (let i = 0; i < articles.length; i++) {
const $more = document.createElement('div');
$more.classList.add('more');$more.innerHTML = moreText;
$more.onclick = function (evt) {
const $src = evt.target || evt.srcElement;$src.parentElement.classList.add('unfold');
};
articles[i].appendChild($more);
}})();
</script>
</section>

</div>
<footer id="footer">

<div class="outer"><div id="footer-info" class="inner">&copy; 2022 时代残党<br>
Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></div>
</div></footer>
</div>
<nav id="mobile-nav">

<a href="/" class="mobile-nav-link">home</a>

<a href="/archives" class="mobile-nav-link">archives</a>

<a href="/app" class="mobile-nav-link">contact</a>

</nav>
<!--

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/2.0.3/jquery.min.js" crossorigin="anonymous" integrity="sha256-pXtSQrmprcTB74RsNlFHuJxHK5zXcPrOMx78uWU0ayU&#x3D; sha384-ECTndYny330R2jlSXBiZkdXzAVi0Z&#x2F;iDXJTwV6cp39HECmalqg6+b2sFZFf&#x2F;Y2m6 sha512-epzJ9ms+0Pq+zFMrG1lXVNvjEXgtfKx9iuEWqz3hmbaU2m&#x2F;Dp1pcmpYzuSdDLqX6PMIjzMOyGFwMc+SkgFhMFg&#x3D;&#x3D;"></script>

-->

<script src="/js/script.js" async></script>

</div>
<script>
(function () {
// append image-caption
const images = document.querySelectorAll('article img');
for (let j = 0; j < images.length; j++) {
const $img = images[j];
const altText = $img.getAttribute('alt');
if (altText && altText.length && !$img.classList.contains('inline')) {
const $imgCaption = document.createElement('div');
$imgCaption.classList.add('img-caption');
$imgCaption.innerText = $img.getAttribute('alt');
$img.parentNode.insertBefore($imgCaption, $img.nextSibling);
}}})();
</script>
</body></html>